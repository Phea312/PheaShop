<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Phea Store</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Font: Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />

    <!-- Vue & SweetAlert -->
    <script src="https://unpkg.com/vue@3.4.21/dist/vue.global.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Tailwind Config to include font -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Poppins', 'sans-serif'],
            },
          },
        },
      };
    </script>
  </head>
  <body class="bg-gray-100 text-gray-800 font-sans">
    <div id="app" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">

      <!-- Navbar -->
      <nav class="bg-white/70 backdrop-blur-md border border-gray-200 shadow-md rounded-xl px-6 py-4 mb-6 flex items-center justify-between">
        <div class="text-2xl font-bold text-blue-700">üõçÔ∏è Fake Store</div>
        <div class="flex gap-6 text-base font-medium text-gray-700">
          <a href="#" class="relative group">
            <span>Home</span>
            <span class="absolute left-0 -bottom-1 w-0 h-0.5 bg-blue-600 transition-all group-hover:w-full"></span>
          </a>
          <a href="#" class="relative group">
            <span>Products</span>
            <span class="absolute left-0 -bottom-1 w-0 h-0.5 bg-blue-600 transition-all group-hover:w-full"></span>
          </a>
          <a href="#" class="relative group">
            <span>About</span>
            <span class="absolute left-0 -bottom-1 w-0 h-0.5 bg-blue-600 transition-all group-hover:w-full"></span>
          </a>
        </div>
      </nav>

      <!-- Header -->
      <header class="bg-white shadow-md rounded-xl p-5 mb-6 sticky top-0 z-50 flex flex-col sm:flex-row items-center justify-between gap-4">
        <h1 class="text-3xl font-extrabold text-blue-700 tracking-wide">Phea Shop</h1>

        <!-- Search -->
        <div class="flex-grow w-full sm:mx-6">
          <input
            v-model="search"
            type="text"
            placeholder="Search products..."
            class="w-full px-4 py-2 rounded-lg border border-gray-300 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none"
          />
        </div>

        <!-- Cart Button -->
        <button
          @click="showCart"
          class="relative inline-flex items-center gap-2 px-5 py-2 text-blue-700 border border-blue-600 rounded-lg hover:bg-blue-100 transition disabled:opacity-50 disabled:cursor-not-allowed"
          :disabled="totalQty === 0"
        >
          üõí <span class="font-semibold">Cart</span>
          <span class="bg-blue-600 text-white text-xs font-bold rounded-full px-2 py-0.5">{{ totalQty }}</span>
        </button>
      </header>

      <!-- Product Grid -->
      <div class="grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
        <div
          v-for="product in filteredProducts"
          :key="product.id"
          class="bg-white rounded-xl shadow-md p-4 flex flex-col hover:shadow-lg transition"
        >
          <img
            :src="product.image"
            alt="Product"
            class="h-48 object-contain mb-4"
          />
          <h2 class="font-semibold text-lg mb-1 line-clamp-1">{{ product.title }}</h2>
          <p class="text-gray-500 text-sm line-clamp-2 mb-2">{{ product.description }}</p>
          <p class="font-bold text-blue-600 mb-4 text-lg">${{ product.price }}</p>
          <button
            @click="addToCart(product)"
            class="mt-auto bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition"
          >
            ‚ûï Add to Cart
          </button>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="mt-16 bg-white shadow-inner rounded-t-xl p-6 text-center text-sm text-gray-600 font-medium">
      <div class="max-w-5xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
        <p>&copy; 2025 <span class="font-semibold text-blue-600">Fake Store</span>. All rights reserved.</p>
        <div class="flex gap-6">
          <a href="#" class="hover:text-blue-600 transition">Privacy</a>
          <a href="#" class="hover:text-blue-600 transition">Terms</a>
          <a href="#" class="hover:text-blue-600 transition">Contact</a>
        </div>
      </div>
    </footer>

    <!-- Vue Script (same as your original) -->
    <script>
      const { createApp, ref, computed, onMounted, watch } = Vue;

      createApp({
        setup() {
          const products = ref([]);
          const cart = ref([]);
          const search = ref("");

          const fetchProducts = async () => {
            const res = await fetch("https://fakestoreapi.com/products");
            products.value = await res.json();
          };

          onMounted(() => {
            const savedCart = localStorage.getItem("cart_list");
            if (savedCart) {
              try {
                cart.value = JSON.parse(savedCart);
              } catch {
                cart.value = [];
              }
            }
            fetchProducts();

            window.addQty = (id) => {
              const item = cart.value.find((p) => p.id === id);
              if (item) item.qty++;
              showCart();
            };
            window.removeQty = (id) => {
              const item = cart.value.find((p) => p.id === id);
              if (item && item.qty > 1) item.qty--;
              showCart();
            };
            window.deleteItem = (id) => {
              cart.value = cart.value.filter((p) => p.id !== id);
              showCart();
            };
          });

          watch(cart, (newCart) => {
            localStorage.setItem("cart_list", JSON.stringify(newCart));
          }, { deep: true });

          const addToCart = (product) => {
            const existing = cart.value.find((p) => p.id === product.id);
            if (existing) {
              existing.qty += 1;
            } else {
              cart.value.push({ ...product, qty: 1 });
            }
          };

          const grandTotal = computed(() =>
            cart.value.reduce((sum, item) => sum + item.price * item.qty, 0).toFixed(2)
          );

          const totalQty = computed(() =>
            cart.value.reduce((sum, item) => sum + item.qty, 0)
          );

          const filteredProducts = computed(() =>
            products.value.filter((p) =>
              p.title.toLowerCase().includes(search.value.toLowerCase())
            )
          );

          const showCart = () => {
            if (cart.value.length === 0) return;

            let html = `
              <div class="max-h-80 overflow-y-auto text-left">
                <table class="w-full text-sm border-collapse border border-gray-200">
                  <thead class="bg-gray-100 sticky top-0">
                    <tr>
                      <th class="py-2 px-3 text-left border-b">Product</th>
                      <th class="py-2 px-3 border-b text-center">Qty</th>
                      <th class="py-2 px-3 border-b text-right">Price</th>
                      <th class="py-2 px-3 border-b text-right">Total</th>
                      <th class="py-2 px-3 border-b text-center">Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${cart.value.map(item => `
                      <tr>
                        <td class="py-2 px-3 border-b">${item.title}</td>
                        <td class="py-2 px-3 border-b text-center">
                          <button onclick="removeQty(${item.id})" class="text-red-600 px-2">‚àí</button>
                          ${item.qty}
                          <button onclick="addQty(${item.id})" class="text-blue-600 px-2">+</button>
                        </td>
                        <td class="py-2 px-3 border-b text-right">$${item.price}</td>
                        <td class="py-2 px-3 border-b text-right">$${(item.price * item.qty).toFixed(2)}</td>
                        <td class="py-2 px-3 border-b text-center">
                          <button onclick="deleteItem(${item.id})" class="text-red-600 text-xl font-bold">&times;</button>
                        </td>
                      </tr>
                    `).join("")}
                  </tbody>
                </table>
              </div>
              <div class="mt-4 text-right text-blue-700 font-bold text-lg">
                Grand Total: $${grandTotal.value}
              </div>
            `;

            Swal.fire({
              title: "üõí Your Cart",
              html,
              showCancelButton: true,
              cancelButtonText: "Close",
              confirmButtonText: "Pay Now",
              width: "1000px",
              focusConfirm: false,
              buttonsStyling: true,
              customClass: {
                popup: "rounded-xl shadow-2xl border border-gray-200",
                confirmButton:
                  "bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2 rounded-lg",
                cancelButton:
                  "bg-red-500 text-white font-semibold px-6 py-2 rounded-lg hover:bg-red-600",
              },
              preConfirm: () => {
                return new Promise((resolve) => {
                  setTimeout(() => resolve(true), 1000);
                });
              },
            }).then((result) => {
              if (result.isConfirmed) {
                Swal.fire({
                  title: '<span style="font-size:1.5rem; font-weight:700; color:#1d4ed8;">‚úì Payment Successful</span>',
                  html: '<p style="font-size:1.1rem; color:#1e40af;">Thank you for your purchase!</p>',
                  background: "#dbeafe",
                  timer: 2500,
                  timerProgressBar: true,
                  showConfirmButton: false,
                  didOpen: () => {
                    Swal.showLoading();
                  },
                });
                cart.value = [];
              }
            });
          };

          return {
            products,
            cart,
            search,
            addToCart,
            showCart,
            filteredProducts,
            totalQty,
          };
        },
      }).mount("#app");
    </script>
  </body>
</html>
